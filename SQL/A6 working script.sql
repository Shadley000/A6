CALL ALARM_PIVOT_UPDATE("2018-01-01", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-02", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-03", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-04", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-05", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-06", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-07", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-08", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-09", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-10", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-11", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-12", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-13", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-14", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-15", 2);
CALL ALARM_PIVOT_UPDATE("2018-01-16", 2);

select distinct cast(ALARM_TIME as date) from ALARM_DATA;

select distinct ALARM_DATE, count(*) from ALARM_DATA group by ALARM_DATE;

select distinct ALARM_DATE, sum(ALARM_COUNT) from ALARM_PIVOT group by ALARM_DATE;
select sum(ALARM_COUNT) from ALARM_PIVOT;

select count(*) from  ALARM_DATA;



select ID, ID_ALARM_FILE, ID_ALARM_TYPE, ALARM_STATUS, ALARM_TIME  
	from ALARM_DATA 
	where ID_INSTALLATION = 2 
	and ALARM_TIME >= '2018-01-01' 
	AND ALARM_TIME < '2018-01-31' 
	ORDER BY ALARM_TIME ASC

select ID, ID_ALARM_FILE, ID_ALARM_TYPE, ALARM_STATUS, ALARM_TIME 
	from ALARM_DATA 
    where ID_INSTALLATION = ? 
    and ALARM_TIME >= ? 
    AND ALARM_TIME < ? ORDER BY ALARM_TIME ASC
    
    describe alarm_data;
    
select distinct alarm_date from alarm_data
select * from alarm_type where ID = 0;
select * from alarm_pivot where ID_ALARM_TYPE = 0;

CALL `a6alarms`.`LOAD_FROM_STAGING`();


SELECT distinct ID_ALARM_TYPE
 FROM ALARM_PIVOT 
 WHERE ID_INSTALLATION = 2 AND ALARM_DATE >= '2018-01-01' AND ALARM_DATE < '2018-01-10' AND ALARM_COUNT >0
 order by ID_ALARM_TYPE;